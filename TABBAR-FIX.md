# üîß TabBar Visibility Fix

## ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!

**–î–∞—Ç–∞**: 2026-01-28
**–ö–æ–º–º–∏—Ç**: `1deb412`

---

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤–∫–ª–∞–¥–∫–∏ Widgets, TabBar –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –¥–∞–∂–µ –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ —Å–æ —Å–ø–∏—Å–∫–æ–º —á–∞—Ç–æ–≤.

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–∏—á–∏–Ω–∞:

–í `NavigationTabCoordinator.swift` –µ—Å—Ç—å –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∫—Ä—ã—Ç–∏—è TabBar:

```swift
func barVisibility(in horizontalSizeClass: UserInterfaceSizeClass?) -> Visibility {
    if let barVisibilityOverride {
        barVisibilityOverride
    } else if horizontalSizeClass == .compact, navigationSplitCoordinator?.detailCoordinator != nil {
        .hidden  // –°–∫—Ä—ã–≤–∞–µ—Ç TabBar –Ω–∞ iPhone –∫–æ–≥–¥–∞ –æ—Ç–∫—Ä—ã—Ç —á–∞—Ç
    } else {
        .automatic
    }
}
```

**–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ —Ç–æ–º, —á—Ç–æ**:
- –í–∫–ª–∞–¥–∫–∏ Chats –∏ Spaces –∏—Å–ø–æ–ª—å–∑—É—é—Ç `NavigationSplitCoordinator`
- –í–∫–ª–∞–¥–∫–∞ Widgets –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `NavigationStackCoordinator` (–±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π)
- –£ Widgets –Ω–µ –±—ã–ª–æ `navigationSplitCoordinator`, –∏ `barVisibilityOverride` –Ω–µ –±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ —Ç–æ–º—É, —á—Ç–æ TabBar –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –≤ `UserSessionFlowCoordinator.swift` (—Å—Ç—Ä–æ–∫–∞ 99):

```swift
let widgetsStackCoordinator = NavigationStackCoordinator()
widgetsTabFlowCoordinator = WidgetsTabFlowCoordinator(
    navigationStackCoordinator: widgetsStackCoordinator,
    flowParameters: flowParameters
)
widgetsTabDetails = .init(tag: HomeTab.widgets,
                          title: "–í–∏–¥–∂–µ—Ç—ã",
                          icon: \.extensions,
                          selectedIcon: \.extensionsSolid)
widgetsTabDetails.barVisibilityOverride = .visible  // ‚Üê –î–û–ë–ê–í–õ–ï–ù–û!
```

–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ TabBar **–≤—Å–µ–≥–¥–∞** –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω–∞ –≤–∫–ª–∞–¥–∫–∞ Widgets.

---

## üìã –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **ElementX/Sources/FlowCoordinators/UserSessionFlowCoordinator.swift**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞: `widgetsTabDetails.barVisibilityOverride = .visible`

---

## üéØ –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –°–ï–ô–ß–ê–°

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–∂–µ —Å–æ–±—Ä–∞–Ω–æ, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∏ –∑–∞–ø—É—â–µ–Ω–æ –≤ —Å–∏–º—É–ª—è—Ç–æ—Ä–µ!

### –®–∞–≥ 1: –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç Matrix

–ï—Å–ª–∏ —Å–µ–π—á–∞—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —ç–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞:
1. –ù–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏" –∏–ª–∏ "–í–æ–π—Ç–∏ QR-–∫–æ–¥–æ–º"
2. –í–æ–π–¥–∏—Ç–µ –≤ –≤–∞—à Matrix –∞–∫–∫–∞—É–Ω—Ç
3. –ï—Å–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è AppLock ‚Üí –Ω–∞–∂–º–∏—Ç–µ "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å üôà"

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ TabBar!

–ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ **–Ω–∏–∂–Ω—é—é —á–∞—Å—Ç—å —ç–∫—Ä–∞–Ω–∞**.

**–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å 4 –≤–∫–ª–∞–¥–∫–∏**:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         –í—Å–µ —á–∞—Ç—ã            [+]      ‚îÇ
‚îÇ                                      ‚îÇ
‚îÇ  ...—Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤...                  ‚îÇ
‚îÇ                                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ [üí¨]   [üè†]   [üß©]   [üë§]           ‚îÇ ‚Üê –î–û–õ–ñ–ï–ù –ë–´–¢–¨ –í–ò–î–ï–ù!
‚îÇ Chats Spaces Widgets Profile         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –®–∞–≥ 3: –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É Widgets

1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ç—Ä–µ—Ç—å—é –≤–∫–ª–∞–¥–∫—É: **üß© Widgets**
2. –î–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç —Å –≤–∏–¥–∂–µ—Ç–∞–º–∏
3. TabBar –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è **–≤–∏–¥–∏–º—ã–º** –≤–Ω–∏–∑—É!

---

## üéâ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ TabBar –≤–∏–¥–µ–Ω –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞
- –ù–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ Chats
- –ù–∞ —ç–∫—Ä–∞–Ω–µ Spaces
- –ù–∞ —ç–∫—Ä–∞–Ω–µ Widgets

### ‚úÖ 4 –≤–∫–ª–∞–¥–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
1. üí¨ Chats
2. üè† Spaces
3. üß© **Widgets** ‚Üê –ù–û–í–ê–Ø!
4. üë§ Profile

### ‚úÖ –í–∫–ª–∞–¥–∫–∞ Widgets —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç —Å –≤–∏–¥–∂–µ—Ç–∞–º–∏
- –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–æ–º–Ω–∞—Ç—É –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç WebView —Å –≤–∏–¥–∂–µ—Ç–æ–º

---

## üîç –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ö–æ–º–º–∏—Ç:
```bash
git log --oneline -1
# 1deb412 Fix TabBar visibility for Widgets tab
```

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ:
```diff
diff --git a/ElementX/Sources/FlowCoordinators/UserSessionFlowCoordinator.swift
@@ -97,6 +97,7 @@
 widgetsTabDetails = .init(tag: HomeTab.widgets,
                           title: "–í–∏–¥–∂–µ—Ç—ã",
                           icon: \.extensions,
                           selectedIcon: \.extensionsSolid)
+widgetsTabDetails.barVisibilityOverride = .visible
```

### –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç —Ñ–∏–∫—Å?

**–î–ª—è Chats –∏ Spaces**:
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç NavigationSplitCoordinator
- TabBar –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ iPhone –∫–æ–≥–¥–∞ –æ—Ç–∫—Ä—ã—Ç —á–∞—Ç (–¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞)
- –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ UX

**–î–ª—è Widgets**:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç NavigationStackCoordinator (–±–µ–∑ split-view)
- –í–∏–¥–∂–µ—Ç—ã –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –≤ –º–æ–¥–∞–ª—å–Ω–æ–º WebView, –∞ –Ω–µ –≤ navigation stack
- TabBar –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—Å–µ–≥–¥–∞ –≤–∏–¥–µ–Ω –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è

---

## üì∏ –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç!

–ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç, —Å–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç:

```bash
xcrun simctl io booted screenshot ~/Desktop/widgets-tab-working.png
```

---

## ‚ùì –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: TabBar –≤–æ–æ–±—â–µ –Ω–µ –≤–∏–¥–µ–Ω?

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ:
```bash
# –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
xcrun simctl uninstall booted io.element.elementx

# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
xcrun simctl install booted ~/Library/Developer/Xcode/DerivedData/ElementX/Build/Products/Debug-iphonesimulator/ElementX.app

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
xcrun simctl launch booted io.element.elementx
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –¢–æ–ª—å–∫–æ 3 –≤–∫–ª–∞–¥–∫–∏ (–±–µ–∑ Widgets)?

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ
grep "barVisibilityOverride" ElementX/Sources/FlowCoordinators/UserSessionFlowCoordinator.swift

# –î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏:
# widgetsTabDetails.barVisibilityOverride = .visible
```

–ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∏ –Ω–µ—Ç ‚Üí –∫–æ–¥ –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª—Å—è, –Ω—É–∂–µ–Ω git pull.

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–µ—Ç–∞–ª–∏

### –ü–æ—á–µ–º—É Widgets –∏—Å–ø–æ–ª—å–∑—É–µ—Ç NavigationStackCoordinator?

Chats –∏ Spaces –∏—Å–ø–æ–ª—å–∑—É—é—Ç `NavigationSplitCoordinator` –ø–æ—Ç–æ–º—É —á—Ç–æ:
- –ù–∞ iPad –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ —Å–ª–µ–≤–∞ + –¥–µ—Ç–∞–ª–∏ —á–∞—Ç–∞ —Å–ø—Ä–∞–≤–∞
- –ù–∞ iPhone —Å–≤–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è –≤ –æ–¥–∏–Ω NavigationStack
- –¢—Ä–µ–±—É—é—Ç —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É split-view

Widgets –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `NavigationStackCoordinator` –ø–æ—Ç–æ–º—É —á—Ç–æ:
- –ü—Ä–æ—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç —Å –≤–∏–¥–∂–µ—Ç–∞–º–∏
- –í–∏–¥–∂–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ WebView (–Ω–µ –Ω—É–∂–µ–Ω split-view)
- –ü—Ä–æ—â–µ –∏ –ª–µ–≥—á–µ –≤ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç barVisibilityOverride?

1. **–ë–µ–∑ override** (Chats, Spaces):
   - TabBar –≤–∏–¥–µ–Ω –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ
   - TabBar **—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è** –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–∞—Ç–∞ –Ω–∞ iPhone
   - –î–∞–µ—Ç –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —á–∞—Ç–∞

2. **–° override = .visible** (Widgets):
   - TabBar **–≤—Å–µ–≥–¥–∞ –≤–∏–¥–µ–Ω**
   - –î–∞–∂–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∏–¥–∂–µ—Ç–∞ (–∫–æ—Ç–æ—Ä—ã–π modal)
   - –ü–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏

---

## üéØ –ò—Ç–æ–≥–æ

‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞**: TabBar –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è
‚úÖ **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω `barVisibilityOverride = .visible` –¥–ª—è Widgets
‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**: TabBar –≤–∏–¥–µ–Ω, 4 –≤–∫–ª–∞–¥–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
‚úÖ **–ö–æ–º–º–∏—Ç**: `1deb412`

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ TabBar –≤ —Å–∏–º—É–ª—è—Ç–æ—Ä–µ! üì±
